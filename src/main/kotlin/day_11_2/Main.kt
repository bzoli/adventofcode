package day_11_2

import java.util.*

fun main() {
    var galaxyMatrix : MutableList<LinkedList<Char>> = lines.lines().map { LinkedList(it.toList()) }
        .toMutableList()
    printMatrix(galaxyMatrix)

    var distanceCalculator = DistanceCalculator(galaxyMatrix)
    distanceCalculator.printMultipliers()

//....#......##
//....#....#...
//.............
//#............
    // 7 8 1 6 7   1 8 3 14   5 6   11
    // println( distanceCalculator.computeDistance(0,0, 12, 3))

    var distanceSum = 0L
    galaxyMatrix.forEachIndexed { rowIndex, chars ->
        chars.forEachIndexed { colIndex, char ->
            if (char.isGalaxyChar()) {

                galaxyMatrix.subList(rowIndex, galaxyMatrix.size).forEachIndexed { rowIndex1, chars1 ->
                    var charStartIndex = if (rowIndex1 == 0) colIndex + 1 else 0
                    chars1.subList(charStartIndex, chars.size).forEachIndexed { colIndex1, char1 ->
                        if (char1.isGalaxyChar()) {
                            var distance : Long =
                                // if (rowIndex1 == 0) colIndex1 + 1 else rowIndex1 + abs(colIndex - colIndex1)
                                if (rowIndex1 == 0){
                                    distanceCalculator.computeDistance(colIndex, rowIndex, colIndex + colIndex1 +1 , rowIndex )
                                } else {
                                    distanceCalculator.computeDistance(colIndex, rowIndex ,  colIndex1 , rowIndex + rowIndex1 )
                                }

                            println("distance: $distance")
                            distanceSum += distance
                        }
                    }
                }
                println()
            }

        }
    }
    println("distanceSum: $distanceSum")

}

class DistanceCalculator (val galaxyMatrix: MutableList<LinkedList<Char>>){
    var spaceMultiplierCols = IntArray(galaxyMatrix[0].size){0}
    var spaceMultiplierRows = IntArray(galaxyMatrix.size){0}
    var MULTIPLIER = 1000000

    init {
        galaxyMatrix.forEachIndexed { index, chars ->
            if (chars == EMPTY_ROW) {
                spaceMultiplierRows[index] = 1
            }
        }

        galaxyMatrix[0].forEachIndexed { colIndex, char ->
            if (EMPTY_SPACE == char) {
                var isAllColEmptySpace = true
                galaxyMatrix.forEachIndexed { rowIndex, row ->
                    if (row[colIndex] != EMPTY_SPACE) {
                        isAllColEmptySpace = false
                    }
                }
                if (isAllColEmptySpace) {
                    spaceMultiplierCols[colIndex] = 1
                }
            }
        }
    }

    fun computeDistance(col1: Int, row1: Int, col2: Int, row2: Int): Long {
        var cntr = 0L;
        for (i in minOf(col1, col2)until maxOf(col1, col2)) {
            cntr += if(MULTIPLIER == 0 || spaceMultiplierCols[i] == 0) 1 else spaceMultiplierCols[i] * MULTIPLIER
        }
        for (i in minOf(row1, row2)until maxOf(row1, row2)) {
            cntr += if(MULTIPLIER == 0 || spaceMultiplierRows[i] == 0) 1 else  spaceMultiplierRows[i] * MULTIPLIER
        }
        return cntr
    }

    fun printMultipliers() {
        spaceMultiplierCols.forEach { print(":$it") }
        println()
        spaceMultiplierRows.forEach { println(it) }
    }

}


val isGalaxyChar: Char.() -> Boolean = { this == GALAXY }
//0123456789ab
//.#......#.##
//............
//........#...
//...##.#.....

val GALAXY = '#'
val EMPTY_SPACE = '.'
val charList = LinkedList<Char>()
val EMPTY_ROW =
    "............................................................................................................................................".toCollection(
        charList
    )
//val EMPTY_ROW = "............".toCollection(charList)

//val EMPTY_ROW = ".............".toCollection(charList)
//const val lines = """....#......##
//....#....#...
//.............
//#............"""

//val EMPTY_ROW = ".............".toCollection(charList)
//const val lines = """....#........
//.........#...
//#............
//.............
//.............
//........#....
//.#...........
//............#
//.............
//.............
//.........#...
//#....#......."""


fun createEmptyRow(): LinkedList<Char> = LinkedList<Char>(List(EMPTY_ROW.size) { '.' })
fun printMatrix(galaxyMatrix: MutableList<LinkedList<Char>>) {
    println()
    galaxyMatrix.forEach {
        it.forEach {
            print(it)
        }
        println()
    }
}


const val lines =
    """.#......................#........................#.........................#................#...............................................
...........................................................................................................#...........#....................
........#...................#.......#............................................#....................#.................................#...
.........................................#............#.........................................#...........................................
....................................................................................................................................#.......
#...........................................................................................................................................
................#......................................................#.............#......................................................
......#..............#.........#......#........................#............................................................................
............#.....................................#......................................#...........................#......................
.....................................................................................................#....................#.................
.....................................................................#.......#............................#......#..............#...........
#...........................................................................................................................................
...................................#.....................................#..................................................................
.........#................#................................#...........................#......#.......................#..................#..
...............#....................................#..........................................................#............................
...........................................#..................................................................................#.............
...............................#...........................................#.......#.................#......................................
#..............................................................#..........................................#.................................
...........#.........................................................#.............................................#........................
......................#...........#...........................................#..........#.....#............................................
........................................................#...............................................................#......#............
...#..........#.........................#................................#..................................................................
............................................................................................................................................
..................#..................................#..............#..................................................................#....
...............................#...........................#...................#.............................#..............................
....................................#....................................................#.............#...............#...................#
................................................................................................#...........................................
.#............#............#........................................................#......................................#................
.......#...................................#........#.......................................................................................
..........................................................#.................................................................................
..............................................................................#..............#.......#................................#.....
.................................#..........................................................................#.........#.....................
....................#....................................................................#......................................#...........
........#...................................#.....................................................................#.........................
#........................#.........................#.............................................#..........................................
.................#.........................................#.........................#......................................................
..............................#.................................#.......................................................................#...
......#...............................#..............................................................................#.............#........
......................................................#..................#.................#............#.......#...........................
..............#...........#......................................................#..........................................................
............................................................#...............................................................................
.....................................................................#......................................................................
.#..................#........................................................................#................................#.............
.........................................#..........................................................................#.......................
.........#.....#..............#..............................................#.........#..............#..............................#.....#
...............................................................................................................#............................
...................................................#...................#...................................................#................
.......................#...........#..............................#......................................#..............................#...
...........#................#...............................................................................................................
...........................................................................#.................................#..............................
................#......................................................................#...........#........................................
.....................................................................................................................#........#......#......
..................................................#.............#..............................#............................................
......#.....#...........#..................#..............................................................#.................................
............................................................................................................................................
...................#...................#..................#....................................................#........................#...
............................................................................................................................................
.........................................................................#..................#...............................................
.....................................................................................................................................#.....#
...................................#...........#....................#.......................................................................
..#.....#.....................................................................#.........................#...................................
...........................#.........................#..................................#..........#..................#.....................
..................................................................................#............................................#............
..............#................#...............................#............................................................................
............................................................................................................................................
.....................................#.........#......................................#..............#........#..........#..................
.....#............#...............................................#........................................................................#
..........................................................................................................#.................................
..........#.............#.....#...........................#.....................#...........................................................
...............................................................#.................................#....................................#.....
....................................#..................................#....................................................................
#......................................................................................................#..........#..........#..............
..........................................#.............................................#...................................................
.................#.............................#........#......................................#.........................#...............#..
......................................#..........................................#..........................................................
............#...............................................#...............................................................................
...........................................................................................#..........................................#.....
.....#................#...............................................................................#.....................................
............................#......................#................#.............................................................#.........
...................................#.........................................................................................#..............
.#.......................................................................#.........#........................#...............................
.........................................#.................#.....................................#...............#..........................
..............................#.............................................................................................................
.................#...............................#.............................#.......#.....#.......#......................................
.......................................................................#....................................................................
............................................................................................................................................
......................................#...........................#.........................................................................
.................................................................................#..........................................................
..................................#.......................#.................................................................................
......................#..............................................#...........................#..........................#.....#.....#...
...........................#............#................................................................#.....#............................
...........................................................................................#................................................
............................................................................................................................................
.........#.........#..........................................................#.............................#.........#.............#.......
...........................................#.............#..................................................................................
............................#..........................................................#..........................#.........................
.......................#.........#..........................................................................................................
......#...........................................#....................#.......................#..........#.................................
...............#.................................................................#..........................................#...............
..........................................................#......#....................................................#............#......#.
......................................................................................................#.....................................
...............................................................................................................#............................
...............................#.....#................#.............................#.......................................................
..#............................................................................#...............#..........................#.................
.......#...................................#........................................................#.......................................
..............................................................#........#.....................................#..............................
...........................#.......#..............#......................................................................................#..
......................#......................................................................................................#......#.......
..............#...........................................................................................#.............#...................
..........................................................#.........#.........................#.............................................
.......................................#.......#...............................#..............................#.............................
................................#...................................................#.......................................................
#..........................................#........#..........#............................................................................
...........................................................................#............#.........................#..................#......
............#...........................................................................................#...................................
...................................#........................................................#...............................................
........................#.................................#......#.......................................................#..................
........#................................................................#..................................................................
...................#..............................#.................................#..............#.........#.....#.............#..........
..........................................#...................#........................................................................#....
.........................................................................................................#..................................
..............................#.........................................................#...................................................
.#..............#...........................................................................................................................
...................................#...........#........................................................................#...................
.........#...............................#........................................................................................#.........
....................#........................................................................#.....................#.........#............#.
..............................................................................#.......................#.......#.............................
.................................#.......................#...............#...............#..................................................
............................................................................................................................................
............................#........#......................................................................................................
......................#........................................#................#...........#..............#........................#.......
.....#.......#........................................................................#..........#........................................#.
..................................................#.........................................................................................
...............................................................................................................#.........#..................
.........................#........#........................#.............#..........................#.......................................
..........#..............................#......................#..........................#................................................
#..................................................................................#........................................................
...............................#................................................................................................#...........
.....................................................#.......#.............................................#................................
......#...............#..............#.........#..................#...............................................#......#...............#.."""