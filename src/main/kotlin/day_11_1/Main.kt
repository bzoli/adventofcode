package day_11_1

import java.util.*
import kotlin.math.abs

fun main() {
    var galaxyMatrix = lines.lines().map { LinkedList(it.toList()) }
        .toMutableList() // var galaxyMatrix: MutableList<LinkedList<Char!>>
    val rowIt = galaxyMatrix.listIterator()
    printMatrix(galaxyMatrix)


        while (rowIt.hasNext()) {
            var row = rowIt.next()
            if (row == EMPTY_ROW) {
                rowIt.add(createEmptyRow())
            }
        }
//    printMatrix(galaxyMatrix)

        val colIt = galaxyMatrix[0].listIterator()
        var colCounter = 0
        while (colIt.hasNext()) {
            var char = colIt.next()
            if (EMPTY_SPACE == char) {
                val rowIt1 = galaxyMatrix.listIterator()
                var isAllColEmptySpace = true
                while (rowIt1.hasNext() && isAllColEmptySpace) {
                    val row = rowIt1.next()
                    if (row[colCounter] != EMPTY_SPACE) {
                        isAllColEmptySpace = false
                    }
                }

                if (isAllColEmptySpace) {
                    colIt.add(EMPTY_SPACE)
                    galaxyMatrix.forEachIndexed { index, row ->
                        if (index > 0) {
                            row.add(colCounter, EMPTY_SPACE)
                        }
                    }
                    colCounter++
                }
            }
            colCounter++
        }
        println("colCounter: $colCounter")
//    printMatrix(galaxyMatrix)

        var distanceSum = 0
        galaxyMatrix.forEachIndexed { rowIndex, chars ->
            chars.forEachIndexed { colIndex, char ->
                if (char.isGalaxyChar()) {
//                .......#...........##
//                .......#........#....
//                #....................
//                10 + 9 + 17 = 36

                    galaxyMatrix.subList(rowIndex, galaxyMatrix.size).forEachIndexed { rowIndex1, chars1 ->
                        var charStartIndex = if (rowIndex1 == 0) colIndex + 1 else 0
                        chars1.subList(charStartIndex, chars.size).forEachIndexed { colIndex1, char1 ->
                            if (char1.isGalaxyChar()) {
                                var distance =
                                    if (rowIndex1 == 0) colIndex1 + 1 else rowIndex1 + abs(colIndex - colIndex1)
                                //println("distance: $distance")
                                distanceSum += distance
                            }
                        }
                    }
                    //println()
                }

            }
        }
        println("distanceSum: $distanceSum")

}

val isGalaxyChar: Char.() -> Boolean = { this == GALAXY }
//0123456789ab
//.#......#.##
//............
//........#...
//...##.#.....

val GALAXY = '#'
val EMPTY_SPACE = '.'
val charList = LinkedList<Char>()
val EMPTY_ROW = "............................................................................................................................................".toCollection(charList)
//val EMPTY_ROW = "............".toCollection(charList)

//val EMPTY_ROW = ".............".toCollection(charList)
//const val lines = """....#......##
//....#....#...
//.............
//#............"""

//val EMPTY_ROW = ".............".toCollection(charList)
//const val lines = """....#........
//.........#...
//#............
//.............
//.............
//........#....
//.#...........
//............#
//.............
//.............
//.........#...
//#....#......."""


fun createEmptyRow(): LinkedList<Char> = LinkedList<Char>(List(EMPTY_ROW.size) { '.' })
fun printMatrix(galaxyMatrix: MutableList<LinkedList<Char>>) {
    println()
    galaxyMatrix.forEach {
        it.forEach {
            print(it)
        }
        println()
    }
}


const val lines =
    """.#......................#........................#.........................#................#...............................................
...........................................................................................................#...........#....................
........#...................#.......#............................................#....................#.................................#...
.........................................#............#.........................................#...........................................
....................................................................................................................................#.......
#...........................................................................................................................................
................#......................................................#.............#......................................................
......#..............#.........#......#........................#............................................................................
............#.....................................#......................................#...........................#......................
.....................................................................................................#....................#.................
.....................................................................#.......#............................#......#..............#...........
#...........................................................................................................................................
...................................#.....................................#..................................................................
.........#................#................................#...........................#......#.......................#..................#..
...............#....................................#..........................................................#............................
...........................................#..................................................................................#.............
...............................#...........................................#.......#.................#......................................
#..............................................................#..........................................#.................................
...........#.........................................................#.............................................#........................
......................#...........#...........................................#..........#.....#............................................
........................................................#...............................................................#......#............
...#..........#.........................#................................#..................................................................
............................................................................................................................................
..................#..................................#..............#..................................................................#....
...............................#...........................#...................#.............................#..............................
....................................#....................................................#.............#...............#...................#
................................................................................................#...........................................
.#............#............#........................................................#......................................#................
.......#...................................#........#.......................................................................................
..........................................................#.................................................................................
..............................................................................#..............#.......#................................#.....
.................................#..........................................................................#.........#.....................
....................#....................................................................#......................................#...........
........#...................................#.....................................................................#.........................
#........................#.........................#.............................................#..........................................
.................#.........................................#.........................#......................................................
..............................#.................................#.......................................................................#...
......#...............................#..............................................................................#.............#........
......................................................#..................#.................#............#.......#...........................
..............#...........#......................................................#..........................................................
............................................................#...............................................................................
.....................................................................#......................................................................
.#..................#........................................................................#................................#.............
.........................................#..........................................................................#.......................
.........#.....#..............#..............................................#.........#..............#..............................#.....#
...............................................................................................................#............................
...................................................#...................#...................................................#................
.......................#...........#..............................#......................................#..............................#...
...........#................#...............................................................................................................
...........................................................................#.................................#..............................
................#......................................................................#...........#........................................
.....................................................................................................................#........#......#......
..................................................#.............#..............................#............................................
......#.....#...........#..................#..............................................................#.................................
............................................................................................................................................
...................#...................#..................#....................................................#........................#...
............................................................................................................................................
.........................................................................#..................#...............................................
.....................................................................................................................................#.....#
...................................#...........#....................#.......................................................................
..#.....#.....................................................................#.........................#...................................
...........................#.........................#..................................#..........#..................#.....................
..................................................................................#............................................#............
..............#................#...............................#............................................................................
............................................................................................................................................
.....................................#.........#......................................#..............#........#..........#..................
.....#............#...............................................#........................................................................#
..........................................................................................................#.................................
..........#.............#.....#...........................#.....................#...........................................................
...............................................................#.................................#....................................#.....
....................................#..................................#....................................................................
#......................................................................................................#..........#..........#..............
..........................................#.............................................#...................................................
.................#.............................#........#......................................#.........................#...............#..
......................................#..........................................#..........................................................
............#...............................................#...............................................................................
...........................................................................................#..........................................#.....
.....#................#...............................................................................#.....................................
............................#......................#................#.............................................................#.........
...................................#.........................................................................................#..............
.#.......................................................................#.........#........................#...............................
.........................................#.................#.....................................#...............#..........................
..............................#.............................................................................................................
.................#...............................#.............................#.......#.....#.......#......................................
.......................................................................#....................................................................
............................................................................................................................................
......................................#...........................#.........................................................................
.................................................................................#..........................................................
..................................#.......................#.................................................................................
......................#..............................................#...........................#..........................#.....#.....#...
...........................#............#................................................................#.....#............................
...........................................................................................#................................................
............................................................................................................................................
.........#.........#..........................................................#.............................#.........#.............#.......
...........................................#.............#..................................................................................
............................#..........................................................#..........................#.........................
.......................#.........#..........................................................................................................
......#...........................................#....................#.......................#..........#.................................
...............#.................................................................#..........................................#...............
..........................................................#......#....................................................#............#......#.
......................................................................................................#.....................................
...............................................................................................................#............................
...............................#.....#................#.............................#.......................................................
..#............................................................................#...............#..........................#.................
.......#...................................#........................................................#.......................................
..............................................................#........#.....................................#..............................
...........................#.......#..............#......................................................................................#..
......................#......................................................................................................#......#.......
..............#...........................................................................................#.............#...................
..........................................................#.........#.........................#.............................................
.......................................#.......#...............................#..............................#.............................
................................#...................................................#.......................................................
#..........................................#........#..........#............................................................................
...........................................................................#............#.........................#..................#......
............#...........................................................................................#...................................
...................................#........................................................#...............................................
........................#.................................#......#.......................................................#..................
........#................................................................#..................................................................
...................#..............................#.................................#..............#.........#.....#.............#..........
..........................................#...................#........................................................................#....
.........................................................................................................#..................................
..............................#.........................................................#...................................................
.#..............#...........................................................................................................................
...................................#...........#........................................................................#...................
.........#...............................#........................................................................................#.........
....................#........................................................................#.....................#.........#............#.
..............................................................................#.......................#.......#.............................
.................................#.......................#...............#...............#..................................................
............................................................................................................................................
............................#........#......................................................................................................
......................#........................................#................#...........#..............#........................#.......
.....#.......#........................................................................#..........#........................................#.
..................................................#.........................................................................................
...............................................................................................................#.........#..................
.........................#........#........................#.............#..........................#.......................................
..........#..............................#......................#..........................#................................................
#..................................................................................#........................................................
...............................#................................................................................................#...........
.....................................................#.......#.............................................#................................
......#...............#..............#.........#..................#...............................................#......#...............#.."""